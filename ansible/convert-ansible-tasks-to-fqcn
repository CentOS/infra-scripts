#!/bin/bash

#
# Simple bash script to parse given .yml task file as parameter to switch to ansible FQCN
# We first declare through array the old name and the new FQCN (collection.name.module_name)
# See below in the ansible_fqcn_mapping
# Warning : this script is stupid, so just test your changes in a dev/staging branch and review before git commit 
# Last update: 2022-04-01
# Imported collections mapping: 
#  ansible.builtin
#  ansible.posix
#  community.general
#  community.libvirt
#  community.mysql
#  community.postgresql
#  containers.podman


# Functions

function usage() {
cat << EOF
You need to call this script with the file you want to parse/modify as only parameter
example: $0 main.yml 
EOF
}


# Variables
# First the mapping between module name and collections
# It's easy to generate by going to where collections is available and one simple snippet
# for example ansible.posix is available under <collections_path>/ansible_collections/ansible/posix/plugins/modules
# So going to that directory and then launching : 
# collection="ansible.posix" ; ls *.py|egrep -v '__init__' | sed 's/.py//'|while read module; do echo "   [\"$module\"]=\"${collection}.${module}\" ";done
# That will generate a mapping we can add to following array :

declare -A ansible_fqcn_mapping=(
   ["add_host"]="ansible.builtin.add_host" 
   ["apt_key"]="ansible.builtin.apt_key" 
   ["apt"]="ansible.builtin.apt" 
   ["apt_repository"]="ansible.builtin.apt_repository" 
   ["assemble"]="ansible.builtin.assemble" 
   ["assert"]="ansible.builtin.assert" 
   ["async_status"]="ansible.builtin.async_status" 
   ["async_wrapper"]="ansible.builtin.async_wrapper" 
   ["blockinfile"]="ansible.builtin.blockinfile" 
   ["command"]="ansible.builtin.command" 
   ["cron"]="ansible.builtin.cron" 
   ["debconf"]="ansible.builtin.debconf" 
   ["debug"]="ansible.builtin.debug" 
   ["dnf"]="ansible.builtin.dnf" 
   ["dpkg_selections"]="ansible.builtin.dpkg_selections" 
   ["expect"]="ansible.builtin.expect" 
   ["fail"]="ansible.builtin.fail" 
   ["fetch"]="ansible.builtin.fetch" 
   ["file"]="ansible.builtin.file" 
   ["find"]="ansible.builtin.find" 
   ["gather_facts"]="ansible.builtin.gather_facts" 
   ["getent"]="ansible.builtin.getent" 
   ["get_url"]="ansible.builtin.get_url" 
   ["git"]="ansible.builtin.git" 
   ["group_by"]="ansible.builtin.group_by" 
   ["group"]="ansible.builtin.group" 
   ["hostname"]="ansible.builtin.hostname" 
   ["import_playbook"]="ansible.builtin.import_playbook" 
   ["import_role"]="ansible.builtin.import_role" 
   ["import_tasks"]="ansible.builtin.import_tasks" 
   ["include_role"]="ansible.builtin.include_role" 
   ["include_tasks"]="ansible.builtin.include_tasks" 
   ["include_vars"]="ansible.builtin.include_vars" 
   ["iptables"]="ansible.builtin.iptables" 
   ["known_hosts"]="ansible.builtin.known_hosts" 
   ["lineinfile"]="ansible.builtin.lineinfile" 
   ["package_facts"]="ansible.builtin.package_facts" 
   ["package"]="ansible.builtin.package" 
   ["pause"]="ansible.builtin.pause" 
   ["ping"]="ansible.builtin.ping" 
   ["pip"]="ansible.builtin.pip" 
   ["raw"]="ansible.builtin.raw" 
   ["reboot"]="ansible.builtin.reboot" 
   ["replace"]="ansible.builtin.replace" 
   ["rpm_key"]="ansible.builtin.rpm_key" 
   ["script"]="ansible.builtin.script" 
   ["service_facts"]="ansible.builtin.service_facts" 
   ["service"]="ansible.builtin.service" 
   ["set_fact"]="ansible.builtin.set_fact" 
   ["set_stats"]="ansible.builtin.set_stats" 
   ["setup"]="ansible.builtin.setup" 
   ["shell"]="ansible.builtin.shell" 
   ["slurp"]="ansible.builtin.slurp" 
   ["stat"]="ansible.builtin.stat" 
   ["subversion"]="ansible.builtin.subversion" 
   ["systemd"]="ansible.builtin.systemd" 
   ["sysvinit"]="ansible.builtin.sysvinit" 
   ["tempfile"]="ansible.builtin.tempfile" 
   ["template"]="ansible.builtin.template" 
   ["unarchive"]="ansible.builtin.unarchive" 
   ["uri"]="ansible.builtin.uri" 
   ["user"]="ansible.builtin.user" 
   ["validate_argument_spec"]="ansible.builtin.validate_argument_spec" 
   ["wait_for_connection"]="ansible.builtin.wait_for_connection" 
   ["wait_for"]="ansible.builtin.wait_for" 
   ["yum"]="ansible.builtin.yum" 
   ["yum_repository"]="ansible.builtin.yum_repository" 
   ["acl"]="ansible.posix.acl" 
   ["at"]="ansible.posix.at" 
   ["authorized_key"]="ansible.posix.authorized_key" 
   ["firewalld_info"]="ansible.posix.firewalld_info" 
   ["firewalld"]="ansible.posix.firewalld" 
   ["mount"]="ansible.posix.mount" 
   ["patch"]="ansible.posix.patch" 
   ["seboolean"]="ansible.posix.seboolean" 
   ["selinux"]="ansible.posix.selinux" 
   ["synchronize"]="ansible.posix.synchronize" 
   ["sysctl"]="ansible.posix.sysctl" 
   ["aerospike_migrations"]="community.general.aerospike_migrations" 
   ["airbrake_deployment"]="community.general.airbrake_deployment" 
   ["aix_devices"]="community.general.aix_devices" 
   ["aix_filesystem"]="community.general.aix_filesystem" 
   ["aix_inittab"]="community.general.aix_inittab" 
   ["aix_lvg"]="community.general.aix_lvg" 
   ["aix_lvol"]="community.general.aix_lvol" 
   ["ali_instance_info"]="community.general.ali_instance_info" 
   ["ali_instance"]="community.general.ali_instance" 
   ["alternatives"]="community.general.alternatives" 
   ["ansible_galaxy_install"]="community.general.ansible_galaxy_install" 
   ["apache2_mod_proxy"]="community.general.apache2_mod_proxy" 
   ["apache2_module"]="community.general.apache2_module" 
   ["apk"]="community.general.apk" 
   ["apt_repo"]="community.general.apt_repo" 
   ["apt_rpm"]="community.general.apt_rpm" 
   ["archive"]="community.general.archive" 
   ["atomic_container"]="community.general.atomic_container" 
   ["atomic_host"]="community.general.atomic_host" 
   ["atomic_image"]="community.general.atomic_image" 
   ["awall"]="community.general.awall" 
   ["beadm"]="community.general.beadm" 
   ["bearychat"]="community.general.bearychat" 
   ["bigpanda"]="community.general.bigpanda" 
   ["bitbucket_access_key"]="community.general.bitbucket_access_key" 
   ["bitbucket_pipeline_key_pair"]="community.general.bitbucket_pipeline_key_pair" 
   ["bitbucket_pipeline_known_host"]="community.general.bitbucket_pipeline_known_host" 
   ["bitbucket_pipeline_variable"]="community.general.bitbucket_pipeline_variable" 
   ["bower"]="community.general.bower" 
   ["bundler"]="community.general.bundler" 
   ["bzr"]="community.general.bzr" 
   ["campfire"]="community.general.campfire" 
   ["capabilities"]="community.general.capabilities" 
   ["cargo"]="community.general.cargo" 
   ["catapult"]="community.general.catapult" 
   ["circonus_annotation"]="community.general.circonus_annotation" 
   ["cisco_spark"]="community.general.cisco_spark" 
   ["cisco_webex"]="community.general.cisco_webex" 
   ["clc_aa_policy"]="community.general.clc_aa_policy" 
   ["clc_alert_policy"]="community.general.clc_alert_policy" 
   ["clc_blueprint_package"]="community.general.clc_blueprint_package" 
   ["clc_firewall_policy"]="community.general.clc_firewall_policy" 
   ["clc_group"]="community.general.clc_group" 
   ["clc_loadbalancer"]="community.general.clc_loadbalancer" 
   ["clc_modify_server"]="community.general.clc_modify_server" 
   ["clc_publicip"]="community.general.clc_publicip" 
   ["clc_server"]="community.general.clc_server" 
   ["clc_server_snapshot"]="community.general.clc_server_snapshot" 
   ["cloudflare_dns"]="community.general.cloudflare_dns" 
   ["cloud_init_data_facts"]="community.general.cloud_init_data_facts" 
   ["cobbler_sync"]="community.general.cobbler_sync" 
   ["cobbler_system"]="community.general.cobbler_system" 
   ["composer"]="community.general.composer" 
   ["consul_acl"]="community.general.consul_acl" 
   ["consul_kv"]="community.general.consul_kv" 
   ["consul"]="community.general.consul" 
   ["consul_session"]="community.general.consul_session" 
   ["copr"]="community.general.copr" 
   ["cpanm"]="community.general.cpanm" 
   ["cronvar"]="community.general.cronvar" 
   ["crypttab"]="community.general.crypttab" 
   ["datadog_downtime"]="community.general.datadog_downtime" 
   ["datadog_event"]="community.general.datadog_event" 
   ["datadog_monitor"]="community.general.datadog_monitor" 
   ["dconf"]="community.general.dconf" 
   ["deploy_helper"]="community.general.deploy_helper" 
   ["dimensiondata_network"]="community.general.dimensiondata_network" 
   ["dimensiondata_vlan"]="community.general.dimensiondata_vlan" 
   ["discord"]="community.general.discord" 
   ["django_manage"]="community.general.django_manage" 
   ["dnf_versionlock"]="community.general.dnf_versionlock" 
   ["dnsimple_info"]="community.general.dnsimple_info" 
   ["dnsimple"]="community.general.dnsimple" 
   ["dnsmadeeasy"]="community.general.dnsmadeeasy" 
   ["dpkg_divert"]="community.general.dpkg_divert" 
   ["easy_install"]="community.general.easy_install" 
   ["ejabberd_user"]="community.general.ejabberd_user" 
   ["elasticsearch_plugin"]="community.general.elasticsearch_plugin" 
   ["emc_vnx_sg_member"]="community.general.emc_vnx_sg_member" 
   ["etcd3"]="community.general.etcd3" 
   ["facter"]="community.general.facter" 
   ["filesize"]="community.general.filesize" 
   ["filesystem"]="community.general.filesystem" 
   ["flatpak"]="community.general.flatpak" 
   ["flatpak_remote"]="community.general.flatpak_remote" 
   ["flowdock"]="community.general.flowdock" 
   ["gandi_livedns"]="community.general.gandi_livedns" 
   ["gconftool2"]="community.general.gconftool2" 
   ["gem"]="community.general.gem" 
   ["git_config"]="community.general.git_config" 
   ["github_deploy_key"]="community.general.github_deploy_key" 
   ["github_issue"]="community.general.github_issue" 
   ["github_key"]="community.general.github_key" 
   ["github_release"]="community.general.github_release" 
   ["github_repo"]="community.general.github_repo" 
   ["github_webhook_info"]="community.general.github_webhook_info" 
   ["github_webhook"]="community.general.github_webhook" 
   ["gitlab_branch"]="community.general.gitlab_branch" 
   ["gitlab_deploy_key"]="community.general.gitlab_deploy_key" 
   ["gitlab_group_members"]="community.general.gitlab_group_members" 
   ["gitlab_group"]="community.general.gitlab_group" 
   ["gitlab_group_variable"]="community.general.gitlab_group_variable" 
   ["gitlab_hook"]="community.general.gitlab_hook" 
   ["gitlab_project_members"]="community.general.gitlab_project_members" 
   ["gitlab_project"]="community.general.gitlab_project" 
   ["gitlab_project_variable"]="community.general.gitlab_project_variable" 
   ["gitlab_protected_branch"]="community.general.gitlab_protected_branch" 
   ["gitlab_runner"]="community.general.gitlab_runner" 
   ["gitlab_user"]="community.general.gitlab_user" 
   ["grove"]="community.general.grove" 
   ["gunicorn"]="community.general.gunicorn" 
   ["hana_query"]="community.general.hana_query" 
   ["haproxy"]="community.general.haproxy" 
   ["heroku_collaborator"]="community.general.heroku_collaborator" 
   ["hg"]="community.general.hg" 
   ["hipchat"]="community.general.hipchat" 
   ["homebrew_cask"]="community.general.homebrew_cask" 
   ["homebrew"]="community.general.homebrew" 
   ["homebrew_tap"]="community.general.homebrew_tap" 
   ["homectl"]="community.general.homectl" 
   ["honeybadger_deployment"]="community.general.honeybadger_deployment" 
   ["hpilo_boot"]="community.general.hpilo_boot" 
   ["hpilo_info"]="community.general.hpilo_info" 
   ["hponcfg"]="community.general.hponcfg" 
   ["htpasswd"]="community.general.htpasswd" 
   ["hwc_ecs_instance"]="community.general.hwc_ecs_instance" 
   ["hwc_evs_disk"]="community.general.hwc_evs_disk" 
   ["hwc_network_vpc"]="community.general.hwc_network_vpc" 
   ["hwc_smn_topic"]="community.general.hwc_smn_topic" 
   ["hwc_vpc_eip"]="community.general.hwc_vpc_eip" 
   ["hwc_vpc_peering_connect"]="community.general.hwc_vpc_peering_connect" 
   ["hwc_vpc_port"]="community.general.hwc_vpc_port" 
   ["hwc_vpc_private_ip"]="community.general.hwc_vpc_private_ip" 
   ["hwc_vpc_route"]="community.general.hwc_vpc_route" 
   ["hwc_vpc_security_group"]="community.general.hwc_vpc_security_group" 
   ["hwc_vpc_security_group_rule"]="community.general.hwc_vpc_security_group_rule" 
   ["hwc_vpc_subnet"]="community.general.hwc_vpc_subnet" 
   ["ibm_sa_domain"]="community.general.ibm_sa_domain" 
   ["ibm_sa_host_ports"]="community.general.ibm_sa_host_ports" 
   ["ibm_sa_host"]="community.general.ibm_sa_host" 
   ["ibm_sa_pool"]="community.general.ibm_sa_pool" 
   ["ibm_sa_vol_map"]="community.general.ibm_sa_vol_map" 
   ["ibm_sa_vol"]="community.general.ibm_sa_vol" 
   ["icinga2_feature"]="community.general.icinga2_feature" 
   ["icinga2_host"]="community.general.icinga2_host" 
   ["idrac_redfish_command"]="community.general.idrac_redfish_command" 
   ["idrac_redfish_config"]="community.general.idrac_redfish_config" 
   ["idrac_redfish_info"]="community.general.idrac_redfish_info" 
   ["ilo_redfish_config"]="community.general.ilo_redfish_config" 
   ["ilo_redfish_info"]="community.general.ilo_redfish_info" 
   ["imc_rest"]="community.general.imc_rest" 
   ["imgadm"]="community.general.imgadm" 
   ["infinity"]="community.general.infinity" 
   ["influxdb_database"]="community.general.influxdb_database" 
   ["influxdb_query"]="community.general.influxdb_query" 
   ["influxdb_retention_policy"]="community.general.influxdb_retention_policy" 
   ["influxdb_user"]="community.general.influxdb_user" 
   ["influxdb_write"]="community.general.influxdb_write" 
   ["ini_file"]="community.general.ini_file" 
   ["installp"]="community.general.installp" 
   ["interfaces_file"]="community.general.interfaces_file" 
   ["ipa_config"]="community.general.ipa_config" 
   ["ipa_dnsrecord"]="community.general.ipa_dnsrecord" 
   ["ipa_dnszone"]="community.general.ipa_dnszone" 
   ["ipa_group"]="community.general.ipa_group" 
   ["ipa_hbacrule"]="community.general.ipa_hbacrule" 
   ["ipa_hostgroup"]="community.general.ipa_hostgroup" 
   ["ipa_host"]="community.general.ipa_host" 
   ["ipa_otpconfig"]="community.general.ipa_otpconfig" 
   ["ipa_otptoken"]="community.general.ipa_otptoken" 
   ["ipa_pwpolicy"]="community.general.ipa_pwpolicy" 
   ["ipa_role"]="community.general.ipa_role" 
   ["ipa_service"]="community.general.ipa_service" 
   ["ipa_subca"]="community.general.ipa_subca" 
   ["ipa_sudocmdgroup"]="community.general.ipa_sudocmdgroup" 
   ["ipa_sudocmd"]="community.general.ipa_sudocmd" 
   ["ipa_sudorule"]="community.general.ipa_sudorule" 
   ["ipa_user"]="community.general.ipa_user" 
   ["ipa_vault"]="community.general.ipa_vault" 
   ["ipify_facts"]="community.general.ipify_facts" 
   ["ipinfoio_facts"]="community.general.ipinfoio_facts" 
   ["ipmi_boot"]="community.general.ipmi_boot" 
   ["ipmi_power"]="community.general.ipmi_power" 
   ["ip_netns"]="community.general.ip_netns" 
   ["iptables_state"]="community.general.iptables_state" 
   ["ipwcli_dns"]="community.general.ipwcli_dns" 
   ["irc"]="community.general.irc" 
   ["iso_create"]="community.general.iso_create" 
   ["iso_extract"]="community.general.iso_extract" 
   ["jabber"]="community.general.jabber" 
   ["java_cert"]="community.general.java_cert" 
   ["java_keystore"]="community.general.java_keystore" 
   ["jboss"]="community.general.jboss" 
   ["jenkins_build"]="community.general.jenkins_build" 
   ["jenkins_job_info"]="community.general.jenkins_job_info" 
   ["jenkins_job"]="community.general.jenkins_job" 
   ["jenkins_plugin"]="community.general.jenkins_plugin" 
   ["jenkins_script"]="community.general.jenkins_script" 
   ["jira"]="community.general.jira" 
   ["kernel_blacklist"]="community.general.kernel_blacklist" 
   ["keycloak_authentication"]="community.general.keycloak_authentication" 
   ["keycloak_client"]="community.general.keycloak_client" 
   ["keycloak_client_rolemapping"]="community.general.keycloak_client_rolemapping" 
   ["keycloak_clientscope"]="community.general.keycloak_clientscope" 
   ["keycloak_clienttemplate"]="community.general.keycloak_clienttemplate" 
   ["keycloak_group"]="community.general.keycloak_group" 
   ["keycloak_identity_provider"]="community.general.keycloak_identity_provider" 
   ["keycloak_realm_info"]="community.general.keycloak_realm_info" 
   ["keycloak_realm"]="community.general.keycloak_realm" 
   ["keycloak_role"]="community.general.keycloak_role" 
   ["keycloak_user_federation"]="community.general.keycloak_user_federation" 
   ["kibana_plugin"]="community.general.kibana_plugin" 
   ["launchd"]="community.general.launchd" 
   ["layman"]="community.general.layman" 
   ["lbu"]="community.general.lbu" 
   ["ldap_attrs"]="community.general.ldap_attrs" 
   ["ldap_entry"]="community.general.ldap_entry" 
   ["ldap_passwd"]="community.general.ldap_passwd" 
   ["ldap_search"]="community.general.ldap_search" 
   ["librato_annotation"]="community.general.librato_annotation" 
   ["linode"]="community.general.linode" 
   ["linode_v4"]="community.general.linode_v4" 
   ["listen_ports_facts"]="community.general.listen_ports_facts" 
   ["lldp"]="community.general.lldp" 
   ["locale_gen"]="community.general.locale_gen" 
   ["logentries_msg"]="community.general.logentries_msg" 
   ["logentries"]="community.general.logentries" 
   ["logstash_plugin"]="community.general.logstash_plugin" 
   ["lvg"]="community.general.lvg" 
   ["lvol"]="community.general.lvol" 
   ["lxca_cmms"]="community.general.lxca_cmms" 
   ["lxca_nodes"]="community.general.lxca_nodes" 
   ["lxc_container"]="community.general.lxc_container" 
   ["lxd_container"]="community.general.lxd_container" 
   ["lxd_profile"]="community.general.lxd_profile" 
   ["macports"]="community.general.macports" 
   ["mail"]="community.general.mail" 
   ["make"]="community.general.make" 
   ["manageiq_alert_profiles"]="community.general.manageiq_alert_profiles" 
   ["manageiq_alerts"]="community.general.manageiq_alerts" 
   ["manageiq_group"]="community.general.manageiq_group" 
   ["manageiq_policies"]="community.general.manageiq_policies" 
   ["manageiq_provider"]="community.general.manageiq_provider" 
   ["manageiq_tags"]="community.general.manageiq_tags" 
   ["manageiq_tenant"]="community.general.manageiq_tenant" 
   ["manageiq_user"]="community.general.manageiq_user" 
   ["mas"]="community.general.mas" 
   ["matrix"]="community.general.matrix" 
   ["mattermost"]="community.general.mattermost" 
   ["maven_artifact"]="community.general.maven_artifact" 
   ["memset_dns_reload"]="community.general.memset_dns_reload" 
   ["memset_memstore_info"]="community.general.memset_memstore_info" 
   ["memset_server_info"]="community.general.memset_server_info" 
   ["memset_zone_domain"]="community.general.memset_zone_domain" 
   ["memset_zone"]="community.general.memset_zone" 
   ["memset_zone_record"]="community.general.memset_zone_record" 
   ["mksysb"]="community.general.mksysb" 
   ["modprobe"]="community.general.modprobe" 
   ["monit"]="community.general.monit" 
   ["mqtt"]="community.general.mqtt" 
   ["mssql_db"]="community.general.mssql_db" 
   ["mssql_script"]="community.general.mssql_script" 
   ["nagios"]="community.general.nagios" 
   ["netcup_dns"]="community.general.netcup_dns" 
   ["newrelic_deployment"]="community.general.newrelic_deployment" 
   ["nexmo"]="community.general.nexmo" 
   ["nginx_status_info"]="community.general.nginx_status_info" 
   ["nictagadm"]="community.general.nictagadm" 
   ["nmcli"]="community.general.nmcli" 
   ["nomad_job_info"]="community.general.nomad_job_info" 
   ["nomad_job"]="community.general.nomad_job" 
   ["nosh"]="community.general.nosh" 
   ["npm"]="community.general.npm" 
   ["nsupdate"]="community.general.nsupdate" 
   ["oci_vcn"]="community.general.oci_vcn" 
   ["odbc"]="community.general.odbc" 
   ["office_365_connector_card"]="community.general.office_365_connector_card" 
   ["ohai"]="community.general.ohai" 
   ["omapi_host"]="community.general.omapi_host" 
   ["oneandone_firewall_policy"]="community.general.oneandone_firewall_policy" 
   ["oneandone_load_balancer"]="community.general.oneandone_load_balancer" 
   ["oneandone_monitoring_policy"]="community.general.oneandone_monitoring_policy" 
   ["oneandone_private_network"]="community.general.oneandone_private_network" 
   ["oneandone_public_ip"]="community.general.oneandone_public_ip" 
   ["oneandone_server"]="community.general.oneandone_server" 
   ["one_host"]="community.general.one_host" 
   ["one_image_info"]="community.general.one_image_info" 
   ["one_image"]="community.general.one_image" 
   ["onepassword_info"]="community.general.onepassword_info" 
   ["one_service"]="community.general.one_service" 
   ["one_template"]="community.general.one_template" 
   ["oneview_datacenter_info"]="community.general.oneview_datacenter_info" 
   ["oneview_enclosure_info"]="community.general.oneview_enclosure_info" 
   ["oneview_ethernet_network_info"]="community.general.oneview_ethernet_network_info" 
   ["oneview_ethernet_network"]="community.general.oneview_ethernet_network" 
   ["oneview_fc_network_info"]="community.general.oneview_fc_network_info" 
   ["oneview_fc_network"]="community.general.oneview_fc_network" 
   ["oneview_fcoe_network_info"]="community.general.oneview_fcoe_network_info" 
   ["oneview_fcoe_network"]="community.general.oneview_fcoe_network" 
   ["oneview_logical_interconnect_group_info"]="community.general.oneview_logical_interconnect_group_info" 
   ["oneview_logical_interconnect_group"]="community.general.oneview_logical_interconnect_group" 
   ["oneview_network_set_info"]="community.general.oneview_network_set_info" 
   ["oneview_network_set"]="community.general.oneview_network_set" 
   ["oneview_san_manager_info"]="community.general.oneview_san_manager_info" 
   ["oneview_san_manager"]="community.general.oneview_san_manager" 
   ["one_vm"]="community.general.one_vm" 
   ["online_server_info"]="community.general.online_server_info" 
   ["online_user_info"]="community.general.online_user_info" 
   ["openbsd_pkg"]="community.general.openbsd_pkg" 
   ["opendj_backendprop"]="community.general.opendj_backendprop" 
   ["open_iscsi"]="community.general.open_iscsi" 
   ["openwrt_init"]="community.general.openwrt_init" 
   ["opkg"]="community.general.opkg" 
   ["osx_defaults"]="community.general.osx_defaults" 
   ["ovh_ip_failover"]="community.general.ovh_ip_failover" 
   ["ovh_ip_loadbalancing_backend"]="community.general.ovh_ip_loadbalancing_backend" 
   ["ovh_monthly_billing"]="community.general.ovh_monthly_billing" 
   ["pacemaker_cluster"]="community.general.pacemaker_cluster" 
   ["packet_device"]="community.general.packet_device" 
   ["packet_ip_subnet"]="community.general.packet_ip_subnet" 
   ["packet_project"]="community.general.packet_project" 
   ["packet_sshkey"]="community.general.packet_sshkey" 
   ["packet_volume_attachment"]="community.general.packet_volume_attachment" 
   ["packet_volume"]="community.general.packet_volume" 
   ["pacman_key"]="community.general.pacman_key" 
   ["pacman"]="community.general.pacman" 
   ["pagerduty_alert"]="community.general.pagerduty_alert" 
   ["pagerduty_change"]="community.general.pagerduty_change" 
   ["pagerduty"]="community.general.pagerduty" 
   ["pagerduty_user"]="community.general.pagerduty_user" 
   ["pamd"]="community.general.pamd" 
   ["pam_limits"]="community.general.pam_limits" 
   ["parted"]="community.general.parted" 
   ["pear"]="community.general.pear" 
   ["pids"]="community.general.pids" 
   ["pingdom"]="community.general.pingdom" 
   ["pip_package_info"]="community.general.pip_package_info" 
   ["pipx"]="community.general.pipx" 
   ["pkg5_publisher"]="community.general.pkg5_publisher" 
   ["pkg5"]="community.general.pkg5" 
   ["pkgin"]="community.general.pkgin" 
   ["pkgng"]="community.general.pkgng" 
   ["pkgutil"]="community.general.pkgutil" 
   ["pmem"]="community.general.pmem" 
   ["portage"]="community.general.portage" 
   ["portinstall"]="community.general.portinstall" 
   ["pritunl_org_info"]="community.general.pritunl_org_info" 
   ["pritunl_org"]="community.general.pritunl_org" 
   ["pritunl_user_info"]="community.general.pritunl_user_info" 
   ["pritunl_user"]="community.general.pritunl_user" 
   ["profitbricks_datacenter"]="community.general.profitbricks_datacenter" 
   ["profitbricks_nic"]="community.general.profitbricks_nic" 
   ["profitbricks"]="community.general.profitbricks" 
   ["profitbricks_volume_attachments"]="community.general.profitbricks_volume_attachments" 
   ["profitbricks_volume"]="community.general.profitbricks_volume" 
   ["proxmox_domain_info"]="community.general.proxmox_domain_info" 
   ["proxmox_group_info"]="community.general.proxmox_group_info" 
   ["proxmox_kvm"]="community.general.proxmox_kvm" 
   ["proxmox_nic"]="community.general.proxmox_nic" 
   ["proxmox"]="community.general.proxmox" 
   ["proxmox_snap"]="community.general.proxmox_snap" 
   ["proxmox_storage_info"]="community.general.proxmox_storage_info" 
   ["proxmox_tasks_info"]="community.general.proxmox_tasks_info" 
   ["proxmox_template"]="community.general.proxmox_template" 
   ["proxmox_user_info"]="community.general.proxmox_user_info" 
   ["pubnub_blocks"]="community.general.pubnub_blocks" 
   ["pulp_repo"]="community.general.pulp_repo" 
   ["puppet"]="community.general.puppet" 
   ["pushbullet"]="community.general.pushbullet" 
   ["pushover"]="community.general.pushover" 
   ["python_requirements_info"]="community.general.python_requirements_info" 
   ["rax_cbs_attachments"]="community.general.rax_cbs_attachments" 
   ["rax_cbs"]="community.general.rax_cbs" 
   ["rax_cdb_database"]="community.general.rax_cdb_database" 
   ["rax_cdb"]="community.general.rax_cdb" 
   ["rax_cdb_user"]="community.general.rax_cdb_user" 
   ["rax_clb_nodes"]="community.general.rax_clb_nodes" 
   ["rax_clb"]="community.general.rax_clb" 
   ["rax_clb_ssl"]="community.general.rax_clb_ssl" 
   ["rax_dns"]="community.general.rax_dns" 
   ["rax_dns_record"]="community.general.rax_dns_record" 
   ["rax_facts"]="community.general.rax_facts" 
   ["rax_files_objects"]="community.general.rax_files_objects" 
   ["rax_files"]="community.general.rax_files" 
   ["rax_identity"]="community.general.rax_identity" 
   ["rax_keypair"]="community.general.rax_keypair" 
   ["rax_meta"]="community.general.rax_meta" 
   ["rax_mon_alarm"]="community.general.rax_mon_alarm" 
   ["rax_mon_check"]="community.general.rax_mon_check" 
   ["rax_mon_entity"]="community.general.rax_mon_entity" 
   ["rax_mon_notification_plan"]="community.general.rax_mon_notification_plan" 
   ["rax_mon_notification"]="community.general.rax_mon_notification" 
   ["rax_network"]="community.general.rax_network" 
   ["rax"]="community.general.rax" 
   ["rax_queue"]="community.general.rax_queue" 
   ["rax_scaling_group"]="community.general.rax_scaling_group" 
   ["rax_scaling_policy"]="community.general.rax_scaling_policy" 
   ["read_csv"]="community.general.read_csv" 
   ["redfish_command"]="community.general.redfish_command" 
   ["redfish_config"]="community.general.redfish_config" 
   ["redfish_info"]="community.general.redfish_info" 
   ["redhat_subscription"]="community.general.redhat_subscription" 
   ["redis_data_incr"]="community.general.redis_data_incr" 
   ["redis_data_info"]="community.general.redis_data_info" 
   ["redis_data"]="community.general.redis_data" 
   ["redis_info"]="community.general.redis_info" 
   ["redis"]="community.general.redis" 
   ["rhevm"]="community.general.rhevm" 
   ["rhn_channel"]="community.general.rhn_channel" 
   ["rhn_register"]="community.general.rhn_register" 
   ["rhsm_release"]="community.general.rhsm_release" 
   ["rhsm_repository"]="community.general.rhsm_repository" 
   ["riak"]="community.general.riak" 
   ["rocketchat"]="community.general.rocketchat" 
   ["rollbar_deployment"]="community.general.rollbar_deployment" 
   ["rpm_ostree_pkg"]="community.general.rpm_ostree_pkg" 
   ["rundeck_acl_policy"]="community.general.rundeck_acl_policy" 
   ["rundeck_job_executions_info"]="community.general.rundeck_job_executions_info" 
   ["rundeck_job_run"]="community.general.rundeck_job_run" 
   ["rundeck_project"]="community.general.rundeck_project" 
   ["runit"]="community.general.runit" 
   ["sapcar_extract"]="community.general.sapcar_extract" 
   ["sap_task_list_execute"]="community.general.sap_task_list_execute" 
   ["say"]="community.general.say" 
   ["scaleway_compute"]="community.general.scaleway_compute" 
   ["scaleway_database_backup"]="community.general.scaleway_database_backup" 
   ["scaleway_image_info"]="community.general.scaleway_image_info" 
   ["scaleway_ip_info"]="community.general.scaleway_ip_info" 
   ["scaleway_ip"]="community.general.scaleway_ip" 
   ["scaleway_lb"]="community.general.scaleway_lb" 
   ["scaleway_organization_info"]="community.general.scaleway_organization_info" 
   ["scaleway_private_network"]="community.general.scaleway_private_network" 
   ["scaleway_security_group_info"]="community.general.scaleway_security_group_info" 
   ["scaleway_security_group"]="community.general.scaleway_security_group" 
   ["scaleway_security_group_rule"]="community.general.scaleway_security_group_rule" 
   ["scaleway_server_info"]="community.general.scaleway_server_info" 
   ["scaleway_snapshot_info"]="community.general.scaleway_snapshot_info" 
   ["scaleway_sshkey"]="community.general.scaleway_sshkey" 
   ["scaleway_user_data"]="community.general.scaleway_user_data" 
   ["scaleway_volume_info"]="community.general.scaleway_volume_info" 
   ["scaleway_volume"]="community.general.scaleway_volume" 
   ["sefcontext"]="community.general.sefcontext" 
   ["selinux_permissive"]="community.general.selinux_permissive" 
   ["selogin"]="community.general.selogin" 
   ["sendgrid"]="community.general.sendgrid" 
   ["sensu_check"]="community.general.sensu_check" 
   ["sensu_client"]="community.general.sensu_client" 
   ["sensu_handler"]="community.general.sensu_handler" 
   ["sensu_silence"]="community.general.sensu_silence" 
   ["sensu_subscription"]="community.general.sensu_subscription" 
   ["seport"]="community.general.seport" 
   ["serverless"]="community.general.serverless" 
   ["shutdown"]="community.general.shutdown" 
   ["slackpkg"]="community.general.slackpkg" 
   ["slack"]="community.general.slack" 
   ["sl_vm"]="community.general.sl_vm" 
   ["smartos_image_info"]="community.general.smartos_image_info" 
   ["snap_alias"]="community.general.snap_alias" 
   ["snap"]="community.general.snap" 
   ["snmp_facts"]="community.general.snmp_facts" 
   ["solaris_zone"]="community.general.solaris_zone" 
   ["sorcery"]="community.general.sorcery" 
   ["spectrum_device"]="community.general.spectrum_device" 
   ["spectrum_model_attrs"]="community.general.spectrum_model_attrs" 
   ["spotinst_aws_elastigroup"]="community.general.spotinst_aws_elastigroup" 
   ["ss_3par_cpg"]="community.general.ss_3par_cpg" 
   ["ssh_config"]="community.general.ssh_config" 
   ["stackdriver"]="community.general.stackdriver" 
   ["stacki_host"]="community.general.stacki_host" 
   ["statsd"]="community.general.statsd" 
   ["statusio_maintenance"]="community.general.statusio_maintenance" 
   ["sudoers"]="community.general.sudoers" 
   ["supervisorctl"]="community.general.supervisorctl" 
   ["svc"]="community.general.svc" 
   ["svr4pkg"]="community.general.svr4pkg" 
   ["swdepot"]="community.general.swdepot" 
   ["swupd"]="community.general.swupd" 
   ["syslogger"]="community.general.syslogger" 
   ["syspatch"]="community.general.syspatch" 
   ["sysrc"]="community.general.sysrc" 
   ["sysupgrade"]="community.general.sysupgrade" 
   ["taiga_issue"]="community.general.taiga_issue" 
   ["telegram"]="community.general.telegram" 
   ["terraform"]="community.general.terraform" 
   ["timezone"]="community.general.timezone" 
   ["twilio"]="community.general.twilio" 
   ["typetalk"]="community.general.typetalk" 
   ["udm_dns_record"]="community.general.udm_dns_record" 
   ["udm_dns_zone"]="community.general.udm_dns_zone" 
   ["udm_group"]="community.general.udm_group" 
   ["udm_share"]="community.general.udm_share" 
   ["udm_user"]="community.general.udm_user" 
   ["ufw"]="community.general.ufw" 
   ["uptimerobot"]="community.general.uptimerobot" 
   ["urpmi"]="community.general.urpmi" 
   ["utm_aaa_group_info"]="community.general.utm_aaa_group_info" 
   ["utm_aaa_group"]="community.general.utm_aaa_group" 
   ["utm_ca_host_key_cert_info"]="community.general.utm_ca_host_key_cert_info" 
   ["utm_ca_host_key_cert"]="community.general.utm_ca_host_key_cert" 
   ["utm_dns_host"]="community.general.utm_dns_host" 
   ["utm_network_interface_address_info"]="community.general.utm_network_interface_address_info" 
   ["utm_network_interface_address"]="community.general.utm_network_interface_address" 
   ["utm_proxy_auth_profile"]="community.general.utm_proxy_auth_profile" 
   ["utm_proxy_exception"]="community.general.utm_proxy_exception" 
   ["utm_proxy_frontend_info"]="community.general.utm_proxy_frontend_info" 
   ["utm_proxy_frontend"]="community.general.utm_proxy_frontend" 
   ["utm_proxy_location_info"]="community.general.utm_proxy_location_info" 
   ["utm_proxy_location"]="community.general.utm_proxy_location" 
   ["vdo"]="community.general.vdo" 
   ["vertica_configuration"]="community.general.vertica_configuration" 
   ["vertica_info"]="community.general.vertica_info" 
   ["vertica_role"]="community.general.vertica_role" 
   ["vertica_schema"]="community.general.vertica_schema" 
   ["vertica_user"]="community.general.vertica_user" 
   ["vexata_eg"]="community.general.vexata_eg" 
   ["vexata_volume"]="community.general.vexata_volume" 
   ["vmadm"]="community.general.vmadm" 
   ["wakeonlan"]="community.general.wakeonlan" 
   ["webfaction_app"]="community.general.webfaction_app" 
   ["webfaction_db"]="community.general.webfaction_db" 
   ["webfaction_domain"]="community.general.webfaction_domain" 
   ["webfaction_mailbox"]="community.general.webfaction_mailbox" 
   ["webfaction_site"]="community.general.webfaction_site" 
   ["xattr"]="community.general.xattr" 
   ["xbps"]="community.general.xbps" 
   ["xcc_redfish_command"]="community.general.xcc_redfish_command" 
   ["xenserver_facts"]="community.general.xenserver_facts" 
   ["xenserver_guest_info"]="community.general.xenserver_guest_info" 
   ["xenserver_guest_powerstate"]="community.general.xenserver_guest_powerstate" 
   ["xenserver_guest"]="community.general.xenserver_guest" 
   ["xfconf_info"]="community.general.xfconf_info" 
   ["xfconf"]="community.general.xfconf" 
   ["xfs_quota"]="community.general.xfs_quota" 
   ["xml"]="community.general.xml" 
   ["yarn"]="community.general.yarn" 
   ["yum_versionlock"]="community.general.yum_versionlock" 
   ["zfs_delegate_admin"]="community.general.zfs_delegate_admin" 
   ["zfs_facts"]="community.general.zfs_facts" 
   ["zfs"]="community.general.zfs" 
   ["znode"]="community.general.znode" 
   ["zpool_facts"]="community.general.zpool_facts" 
   ["zypper"]="community.general.zypper" 
   ["zypper_repository"]="community.general.zypper_repository" 
   ["virt_net"]="community.libvirt.virt_net" 
   ["virt_pool"]="community.libvirt.virt_pool" 
   ["virt"]="community.libvirt.virt" 
   ["mysql_db"]="community.mysql.mysql_db" 
   ["mysql_info"]="community.mysql.mysql_info" 
   ["mysql_query"]="community.mysql.mysql_query" 
   ["mysql_replication"]="community.mysql.mysql_replication" 
   ["mysql_role"]="community.mysql.mysql_role" 
   ["mysql_user"]="community.mysql.mysql_user" 
   ["mysql_variables"]="community.mysql.mysql_variables" 
   ["postgresql_db"]="community.postgresql.postgresql_db" 
   ["postgresql_ext"]="community.postgresql.postgresql_ext" 
   ["postgresql_idx"]="community.postgresql.postgresql_idx" 
   ["postgresql_info"]="community.postgresql.postgresql_info" 
   ["postgresql_lang"]="community.postgresql.postgresql_lang" 
   ["postgresql_membership"]="community.postgresql.postgresql_membership" 
   ["postgresql_owner"]="community.postgresql.postgresql_owner" 
   ["postgresql_pg_hba"]="community.postgresql.postgresql_pg_hba" 
   ["postgresql_ping"]="community.postgresql.postgresql_ping" 
   ["postgresql_privs"]="community.postgresql.postgresql_privs" 
   ["postgresql_publication"]="community.postgresql.postgresql_publication" 
   ["postgresql_query"]="community.postgresql.postgresql_query" 
   ["postgresql_schema"]="community.postgresql.postgresql_schema" 
   ["postgresql_script"]="community.postgresql.postgresql_script" 
   ["postgresql_sequence"]="community.postgresql.postgresql_sequence" 
   ["postgresql_set"]="community.postgresql.postgresql_set" 
   ["postgresql_slot"]="community.postgresql.postgresql_slot" 
   ["postgresql_subscription"]="community.postgresql.postgresql_subscription" 
   ["postgresql_table"]="community.postgresql.postgresql_table" 
   ["postgresql_tablespace"]="community.postgresql.postgresql_tablespace" 
   ["postgresql_user_obj_stat_info"]="community.postgresql.postgresql_user_obj_stat_info" 
   ["postgresql_user"]="community.postgresql.postgresql_user" 
   ["podman_container_info"]="containers.podman.podman_container_info" 
   ["podman_container"]="containers.podman.podman_container" 
   ["podman_containers"]="containers.podman.podman_containers" 
   ["podman_export"]="containers.podman.podman_export" 
   ["podman_image_info"]="containers.podman.podman_image_info" 
   ["podman_image"]="containers.podman.podman_image" 
   ["podman_import"]="containers.podman.podman_import" 
   ["podman_load"]="containers.podman.podman_load" 
   ["podman_login_info"]="containers.podman.podman_login_info" 
   ["podman_login"]="containers.podman.podman_login" 
   ["podman_logout"]="containers.podman.podman_logout" 
   ["podman_network_info"]="containers.podman.podman_network_info" 
   ["podman_network"]="containers.podman.podman_network" 
   ["podman_play"]="containers.podman.podman_play" 
   ["podman_pod_info"]="containers.podman.podman_pod_info" 
   ["podman_pod"]="containers.podman.podman_pod" 
   ["podman_save"]="containers.podman.podman_save" 
   ["podman_secret"]="containers.podman.podman_secret" 
   ["podman_tag"]="containers.podman.podman_tag" 
   ["podman_volume_info"]="containers.podman.podman_volume_info" 
   ["podman_volume"]="containers.podman.podman_volume" 
)

# List of modules/tasks that have also same parameter name so to be reviewed !
ansible_conflicting_modules="replace"
# File to modify and check if exist
if [ -z "$1" ]; then
  usage
  exit 1
else
  file="$1"
fi

# Now parsing array and modifying file
for key in ${!ansible_fqcn_mapping[@]} ; do
  grep -q " ${key}:" $1
  if [ "$?" -eq "0" ] ; then
    echo "Ansible module [$key] found in $1"
    echo " => replacing [$key] with [${ansible_fqcn_mapping[${key}]}]"
    sed -i "s/ ${key}:/ ${ansible_fqcn_mapping[${key}]}:/g" $file
    echo ${ansible_conflicting_modules}|grep -q ${key}
    if [ "$?" -eq "0" ]; then
    echo "=== [WARNING] : Verify manually as ${key} can mean a module but also a parameter !"
    fi
  fi

done


